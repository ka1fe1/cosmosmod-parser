package integration

import (
	"encoding/hex"
	"fmt"
	. "github.com/kaifei-bianjie/common-parser/codec"
	"github.com/kaifei-bianjie/common-parser/utils"
)

func (s IntegrationTestSuite) TestGov() {
	cases := []SubTest{
		{
			"submitProposal",
			submitProposal,
		},
	}

	for _, t := range cases {
		s.Run(t.testName, func() {
			t.testCase(s)
		})
	}
}

func submitProposal(s IntegrationTestSuite) {
	SetBech32Prefix(Bech32PrefixAccAddr, Bech32PrefixAccPub, Bech32PrefixValAddr,
		Bech32PrefixValPub, Bech32PrefixConsAddr, Bech32PrefixConsPub)
	txBytes, err := hex.DecodeString("0AE50E0AE20E0A202F636F736D6F732E676F762E76312E4D73675375626D697450726F706F73616C12BD0E0AFD0D0A252F636F736D6F732E676F762E763162657461312E4D73675375626D697450726F706F73616C12D30D0A940D0A2E2F636F736D6F732E706172616D732E763162657461312E506172616D657465724368616E676550726F706F73616C12E10C0A0C506172616D204368616E6765121B5570646174652048544C43206465707574795F61646472657373201AB30C0A0468746C63120B4173736574506172616D731A9D0C5B0A20202020202020207B0A202020202020202020202264656E6F6D223A202268746C746263626E62222C0A2020202020202020202022737570706C795F6C696D6974223A207B0A202020202020202020202020226C696D6974223A2022333530303030303030303030303030222C0A2020202020202020202020202274696D655F6C696D69746564223A2066616C73652C0A2020202020202020202020202274696D655F706572696F64223A202230222C0A2020202020202020202020202274696D655F62617365645F6C696D6974223A202230220A202020202020202020207D2C0A2020202020202020202022616374697665223A20747275652C0A20202020202020202020226465707574795F61646472657373223A2022696161316571766B667468747272393367347039717370703534773664746A74726E3237617237727077222C0A202020202020202020202266697865645F666565223A202231303030222C0A20202020202020202020226D696E5F737761705F616D6F756E74223A202231303031222C0A20202020202020202020226D61785F737761705F616D6F756E74223A202231303030303030303030303030222C0A20202020202020202020226D696E5F626C6F636B5F6C6F636B223A20223530222C0A20202020202020202020226D61785F626C6F636B5F6C6F636B223A2022323530220A20202020202020207D2C0A097B0A202020202020202020202264656E6F6D223A202268746C74626362757364222C0A2020202020202020202022737570706C795F6C696D6974223A207B0A202020202020202020202020226C696D6974223A2022333530303030303030303030303030222C0A2020202020202020202020202274696D655F6C696D69746564223A2066616C73652C0A2020202020202020202020202274696D655F706572696F64223A202230222C0A2020202020202020202020202274696D655F62617365645F6C696D6974223A202230220A202020202020202020207D2C0A2020202020202020202022616374697665223A20747275652C0A20202020202020202020226465707574795F61646472657373223A2022696161316571766B667468747272393367347039717370703534773664746A74726E3237617237727077222C0A202020202020202020202266697865645F666565223A20223230303030222C0A20202020202020202020226D696E5F737761705F616D6F756E74223A20223230303031222C0A20202020202020202020226D61785F737761705F616D6F756E74223A20223135303030303030303030303030222C0A20202020202020202020226D696E5F626C6F636B5F6C6F636B223A20223530222C0A20202020202020202020226D61785F626C6F636B5F6C6F636B223A2022323530220A20202020202020207D2C0A20202020202020207B0A202020202020202020202264656E6F6D223A202268746C7464656E6F6D222C0A2020202020202020202022737570706C795F6C696D6974223A207B0A202020202020202020202020226C696D6974223A2022333530303030303030303030303030222C0A2020202020202020202020202274696D655F6C696D69746564223A2066616C73652C0A2020202020202020202020202274696D655F706572696F64223A202230222C0A2020202020202020202020202274696D655F62617365645F6C696D6974223A202230220A202020202020202020207D2C0A2020202020202020202022616374697665223A20747275652C0A20202020202020202020226465707574795F61646472657373223A2022696161316571766B667468747272393367347039717370703534773664746A74726E3237617237727077222C0A202020202020202020202266697865645F666565223A20223230303030222C0A20202020202020202020226D696E5F737761705F616D6F756E74223A20223230303031222C0A20202020202020202020226D61785F737761705F616D6F756E74223A20223135303030303030303030303030222C0A20202020202020202020226D696E5F626C6F636B5F6C6F636B223A20223530222C0A20202020202020202020226D61785F626C6F636B5F6C6F636B223A2022323530220A20202020202020207D0A2020202020205D120E0A05756E79616E120531303030301A2A696161313064303779323635676D6D757674347A30773961773838306A6E73723730306A30716E35357A120F0A05756E79616E12063130303030301A2A696161316571766B667468747272393367347039717370703534773664746A74726E323761723772707712680A510A460A1F2F636F736D6F732E63727970746F2E736563703235366B312E5075624B657912230A21038BE4539785F0621A19066EB2DA45C11DCC5FCCFF5D58E89C670BB80D251CC1B712040A02080118AC0212130A0D0A05756E79616E1204343030301080B5181A403330D4024D08E9BDA93F5F1FDE118889EB17D774CC38EC1D265E9A283B72B50473ADF896E78AEF26AF817BEE3D9728837DA3E5D8CB93879DBB0069B7C46281F7")
	//txBytes, err := hex.DecodeString("0AEB020AA6020A252F636F736D6F732E676F762E763162657461312E4D73675375626D697450726F706F73616C12FC010ABF010A2E2F636F736D6F732E706172616D732E763162657461312E506172616D657465724368616E676550726F706F73616C128C010A1977777777775365727669636520506172616D204368616E676512217777777777557064617465206D6178204D61785265717565737454696D656F75741A4C0A03676F76120D6465706F736974706172616D731A367B226D696E5F6465706F736974223A205B7B22616D6F756E74223A20223130222C2264656E6F6D223A2022756E79616E22207D5D207D120C0A05756E79616E12033130301A2A696161316D756D7672333865647378753471306A7A7436777A61667A6A7A79683239777766396A32613412406265697A68756164666173646661736466617364666161736466617364666173646661736466617364666173646661736466736661736466617364666173646612660A500A460A1F2F636F736D6F732E63727970746F2E736563703235366B312E5075624B657912230A2103A2436FB2F383FFA6AEE9D6CB5D73E35F72FD0FCB0802AD3DA398A7F724F68F8C12040A020801180812120A0C0A05756E79616E12033830301080B5181A40F5FD45CBF3CBB36664F53C7D64550037920E523F59B0C98BE8FCDE308BBFA776361518BB567DA3E8F42ACAF153C436919EECED9399D22CB9B98F006E537673D2")
	if err != nil {
		fmt.Println(err.Error())
	}
	authTx, err := GetSigningTx(txBytes)
	if err != nil {
		fmt.Println(err.Error())
	}
	for _, msg := range authTx.GetMsgs() {
		if bankDoc, ok := s.Gov.HandleTxMsg(msg); ok {
			fmt.Println(utils.MarshalJsonIgnoreErr(bankDoc))
		}
	}
}
